# Agent notes for backend

- When running Go tests under the sandbox, do NOT set `GOCACHE` or  `GOMODCACHE` to non-standard paths. If the test run fails, ask the user to run the tests manually to warm up the cache.
- For component-wise coverage in `backend/local-engine-go`, create a `coverage` directory (remove a file named `coverage` if it exists), then run per-package with timeouts and `-coverprofile` targets. Example (PowerShell):
  - `Remove-Item -Force coverage -ErrorAction SilentlyContinue; New-Item -ItemType Directory -Force -Path coverage | Out-Null; $tasks = @(@{Pkg="./cmd/sqlrs-engine"; Timeout="2m"; Out="cmd-sqlrs-engine.out"}, @{Pkg="./internal/auth"; Timeout="1m"; Out="internal-auth.out"}, @{Pkg="./internal/conntrack"; Timeout="1m"; Out="internal-conntrack.out"}, @{Pkg="./internal/dbms"; Timeout="1m"; Out="internal-dbms.out"}, @{Pkg="./internal/deletion"; Timeout="1m"; Out="internal-deletion.out"}, @{Pkg="./internal/httpapi"; Timeout="2m"; Out="internal-httpapi.out"}, @{Pkg="./internal/id"; Timeout="1m"; Out="internal-id.out"}, @{Pkg="./internal/prepare"; Timeout="2m"; Out="internal-prepare.out"}, @{Pkg="./internal/prepare/queue"; Timeout="1m"; Out="internal-prepare-queue.out"}, @{Pkg="./internal/registry"; Timeout="1m"; Out="internal-registry.out"}, @{Pkg="./internal/runtime"; Timeout="1m"; Out="internal-runtime.out"}, @{Pkg="./internal/snapshot"; Timeout="1m"; Out="internal-snapshot.out"}, @{Pkg="./internal/store/sqlite"; Timeout="1m"; Out="internal-store-sqlite.out"}, @{Pkg="./internal/stream"; Timeout="1m"; Out="internal-stream.out"}); foreach ($t in $tasks) { go test $t.Pkg -timeout $t.Timeout -coverprofile (Join-Path coverage $t.Out); if ($LASTEXITCODE -ne 0) { throw "tests failed: $($t.Pkg)" } }`
